<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Notes</title>

  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#1b2030" />
  <link rel="apple-touch-icon" href="icons/icon-192.png" />
  <link rel="stylesheet" href="styles.css" />

  <!-- CodeMirror (CDN) -->
<!-- CodeMirror (local vendor copy) -->
<link rel="stylesheet" href="vendor/codemirror.css" />
<script src="vendor/codemirror.js"></script>
<script src="vendor/javascript.js"></script>

</head>

<body>
  <!-- ======= HEADER / CARD VIEW ======= -->
<header class="app-header" id="appHeader">
  <div class="header-actions">

    <!-- Category filter trigger (unchanged) -->
    <div id="categoryFilterTrigger" class="category-trigger">
      <span id="categoryFilterLabel">All Categories</span>
      <div class="cat-swatch tiny"></div>
    </div>

    <!-- Desktop search (always visible on desktop) -->
    <div class="search-wrap" id="searchWrap">
      <span class="search-icon" aria-hidden="true">ğŸ”</span>
      <input id="searchInput" class="search-input" type="search" placeholder="Search notesâ€¦" autocomplete="off" />
      <button id="searchResetBtn" class="search-reset-btn" aria-label="Clear search" title="Clear">âœ–</button>
    </div>

    <div class="spacer"></div>

    <!-- Mobile search entry point (icons only on mobile) -->
    <button id="searchOpenBtn" class="icon-btn mobile-only" title="Search" aria-label="Search">ğŸ”</button>

    <!-- Settings gear -->
    <button id="settingsBtn" class="icon-btn" title="Settings">âš™ï¸</button>
  </div>

  <!-- Mobile search bar mode (slides in, replaces header content) -->
  <div class="mobile-search-bar" id="mobileSearchBar" aria-hidden="true">
    <input id="mobileSearchInput" class="mobile-search-input" type="search" placeholder="Search notesâ€¦" autocomplete="off" />
    <button id="mobileSearchCloseBtn" class="icon-btn" aria-label="Close search" title="Close">âœ–</button>
  </div>
</header>


<!-- Settings Modal -->
<div id="settingsModal" class="modal hidden" role="dialog" aria-modal="true">
  <div class="modal-card">
    <div class="modal-header">
      <h3>Settings</h3>
      <button id="closeSettingsBtn" class="icon-btn">âœ•</button>
    </div>

    <section class="settings-section">
      <h4>Theme</h4>
      <div class="theme-options">
        <button id="lightThemeBtn" class="btn ghost">ğŸŒ Light</button>
        <button id="darkThemeBtn" class="btn ghost">ğŸŒ™ Dark</button>
        <button id="materialThemeBtn" class="btn ghost">ğŸŸ£ Material</button>
      </div>
    </section>

    <section class="settings-section" data-section="categories">
      <h4>Categories</h4>
      <div id="categoriesList" class="category-list"></div>
      <div class="category-form">
        <input id="newCategoryName" class="input" placeholder="Category name (e.g., Work, Ideas)" />
        <input id="newCategoryColor" class="input" type="color" value="#F0F4FF" />
        <button id="addCategoryBtn" class="btn primary">Add</button>
      </div>
    </section>
  </div>
</div>

  <main>
    <section id="cardsView" class="cards-grid" aria-live="polite"></section>
  </main>

  <!-- ======= NOTE EDITOR OVERLAY ======= -->
  <div id="editorOverlay" class="overlay hidden" role="dialog" aria-modal="true">
    <div id="editorPanel" class="editor-panel">

      <!-- --- TOP BAR --- -->
      <div class="editor-topbar">
  <button id="closeEditorBtn" class="icon-btn" title="Back" aria-label="Back">âŸµ</button>
  <input id="noteTitle" class="title-input" placeholder="Untitledâ€¦" />
  <div id="categorySelectTrigger" class="category-trigger small">
    <span id="categorySelectLabel">Select Category</span>
    <div class="cat-swatch tiny"></div>
  </div>
  <button id="moreMenuBtn" class="icon-btn" title="More">â‹®</button>
</div>


      <!-- --- FORMAT BAR (always visible) --- -->
      <div class="editor-formatbar">
        <button class="tool" data-cmd="bold" title="Bold (Ctrl+B)">B</button>
        <button class="tool" data-cmd="italic" title="Italic (Ctrl+I)">I</button>
        <button class="tool" data-cmd="underline" title="Underline (Ctrl+U)">U</button>
        <button id="insertCheckboxBtn" class="tool" title="Insert checklist">â˜‘ï¸</button>
      </div>

      <!-- --- EDITORS --- -->
      <div id="richEditor" class="editor" contenteditable="true" spellcheck="true"></div>
      <textarea id="codeEditor" class="code-editor hidden" spellcheck="false"></textarea>

      <!-- --- SAVE STATUS --- -->
      <div class="editor-bottombar">
        <div id="saveStatus" class="save-status">Saved âœ“</div>
      </div>
    </div>

    <!-- --- FLOATING 3-DOT MENU --- -->
    <div id="moreMenu" class="dropdown hidden">
      <button id="addImageMenuBtn" class="dropdown-item">Add Image</button>
      <button id="addVoiceMenuBtn" class="dropdown-item">Record Voice</button>
      <button id="toggleCodeMenuBtn" class="dropdown-item">Toggle Code Mode &lt;/&gt;</button>
      <button id="deleteNoteMenuBtn" class="dropdown-item danger">Delete Note</button>
    </div>
    <input id="imageInput" type="file" accept="image/*" hidden />
  </div>

  <!-- ======= CATEGORY OVERLAY (custom list) ======= -->
  <div id="categoryOverlay" class="modal hidden" role="dialog" aria-modal="true">
    <div class="modal-card small">
      <div class="modal-header">
        <h3>Select Category</h3>
        <button id="closeCategoryOverlayBtn" class="icon-btn">âœ•</button>
      </div>
      <div id="categoryOverlayList" class="category-list"></div>
    </div>
  </div>

  <!-- ======= CATEGORY MANAGER ======= -->
  <div id="categoriesModal" class="modal hidden" role="dialog" aria-modal="true" aria-label="Manage Categories">
    <div class="modal-card">
      <div class="modal-header">
        <h3>Manage Categories</h3>
        <button id="closeCategoriesBtn" class="icon-btn" aria-label="Close">âœ•</button>
      </div>
      <div id="categoriesList" class="category-list"></div>
      <div class="category-form">
        <input id="newCategoryName" class="input" placeholder="Category name (e.g., Work, Ideas)" />
        <input id="newCategoryColor" class="input" type="color" value="#F0F4FF" />
        <button id="addCategoryBtn" class="btn primary">Add</button>
      </div>
    </div>
  </div>
<!-- Floating Action Button -->
<button id="fabNewNote" class="fab-btn" title="New note">+</button>
  <!-- ======= SCRIPTS ======= -->
  <script type="module" src="app.js"></script>
  <script type="module" src="db.js"></script>
  <script type="module" src="color.js"></script>
  <script type="module" src="editor.js"></script>
  <script type="module" src="audio.js"></script>
  <script type="module" src="ui.js"></script>
  <script type="module" src="sync.js"></script>
  <script type="module" src="pwa.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/lib/common.min.js"></script>
</body>
</html>